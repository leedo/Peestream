? my $msg = shift;
<tr>
  <td class="info">
    <span class="author"><?= $msg->author ?></span><br>
    <span class="time"><?= $msg->datetime ?></span>
  </td>
  <td class="body">
    <? for (@{$msg->files}) { ?>
      <? if ($_->is_image) { ?>
        <img src="<?= $_->path ?>" />
      <? } else { ?>
        <a href="<?= $_->path ?>"><?= $_->filename ?></a>
      <? } ?>
    <? } ?>
    <? for (split /\n/, $msg->body) { ?>
      <p><?= $_ ?></p>
    <? } ?>
  </td>
</tr>
